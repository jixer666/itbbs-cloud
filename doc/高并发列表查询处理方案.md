# 高并发列表查询处理方案

## 业务场景

首页文章列表查询就是一个典型的高并发分页查询，读多写少，写是因为展示的浏览量、点赞量等计数信息会变化，初次之外其他的信息基本不变

## 技术实现

定时任务每隔24小时（一天）重新加载一次需要提前构建的列表缓存，列表采用 Redis 的 zset 结构存储文章 ID，系统这里需要构建按时间、按热度排序的文章列表热度，使用了策略者模式，方便拓展其他的列表查询。文章详细信息也需要存储下来，采用 Hash 结构

每天构建缓存只查询前1000条数据，当然了这个1000的取值是要看业务的大小，如业务很大，可以适当取大一点，系统每次分页查询10条，1000页全部去完也需要滑动100次才行，一般场景完全够用，谁没事去一直滑动[狗头]，极端场景就算查询完了1000条数据，也会去数据库查询接下来的数据并缓存。热数据走缓存，冷数据走数据库查询并缓存

这一天之内发布或下架文章都会对 zset 和 hash 进行更新，不会影响到业务数据展示

对于频繁更新的字段：浏览量、点赞量和收藏量，采用的是在处理文章计数量定时任务（10秒一次，参考**浏览量、点赞量和收藏量处理方案**）的时候更改 hash 中的数据，也就是说在点击更新后到页面列表展示会有10秒中短暂的数据不一致性，但能接受