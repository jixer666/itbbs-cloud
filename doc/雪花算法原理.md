# 雪花算法原理

## 组成原理

雪花算法组成：符号位(1) + 时间戳(41) + 机器号(10) + 序列号(12)，一共64位

- 符号位固定位是0
- 时间戳计算是当前时间 - 起始时间的二进制，因此最多可用2^41 ≈ 69年
- 机器ID是由数据中心(5) + 机器ID(5) 组成，因此最多2^5 * 2^5个节点 
- 序列号是每秒自增的序号，因此同一秒最多2^12 = 4096个ID

## 举例

- 当前时间戳：1704067300123（比起始时间戳多100123毫秒）
- 数据中心ID：1（二进制：00001）
- 机器ID：3（二进制：00011）
- 序列号：256（二进制：000100000000）

**生成步骤：**

1. 计算时间差：1704067300123 - 1704067200000 = 100123
   二进制：11000011010111011（17位，高位补0到41位）
   
2. 组合各部分：
   ┌────┬───────────────────────┬─────────────┬─────┬──────────┐
   │符号位│        时间戳                                            │ 数据中心ID               │  机器ID  │序列号              │
   │ 0         │000...00011000011010111011         │   00001                     │  00011  │000100000000│
   └────┴───────────────────────┴─────────────┴─────┴──────────┘
   
3. 转换为十进制：
   最终ID：676376170700800

